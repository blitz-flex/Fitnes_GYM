{% extends "admin/base.html" %}

{% block title %}რეგისტრაციები - Admin Panel{% endblock %}
{% block page_title %}რეგისტრაციები{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h3 class="card-title">პროგრამების რეგისტრაციები</h3>
        <div class="header-stats">
            <span class="badge bg-primary">ჯამი: {{ registrations.total if registrations else 0 }}</span>
        </div>
    </div>

    {% if registrations and registrations.items %}
    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                        <th>სახელი გვარი</th>
                    <th>ტელეფონი</th>
                    <th>პროგრამა</th>
                    <th>შექმნილია</th>
                    <th>მოქმედება</th>
                </tr>
            </thead>
            <tbody>
                {% for reg in registrations.items %}
                <tr>
                    <td>{{ reg.full_name }}</td>
                    <td>{{ reg.phone_number }}</td>
                    <td>
                        <span class="program-badge">{{ reg.program }}</span>
                    </td>
                    <td>{{ reg.created_at.strftime('%d.%m.%Y') }}</td>
                    <td>
                        <div class="action-buttons">

                            <form method="POST" action="{{ url_for('admin.delete_registration', reg_id=reg.id) }}" class="d-inline">
                                <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('დარწმუნებული ხართ რეგისტრაციის წაშლაში?')">
                                    <i class="fas fa-trash"></i> წაშლა
                                </button>
                            </form>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    {% if registrations.pages > 1 %}
    <div class="card-footer">
        <nav aria-label="რეგისტრაციების გვერდები">
            <ul class="pagination justify-content-center">
                {% if registrations.has_prev %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('admin.registrations', page=registrations.prev_num) }}">წინა</a>
                    </li>
                {% endif %}

                {% for page_num in registrations.iter_pages() %}
                    {% if page_num %}
                        {% if page_num != registrations.page %}
                            <li class="page-item">
                                <a class="page-link" href="{{ url_for('admin.registrations', page=page_num) }}">{{ page_num }}</a>
                            </li>
                        {% else %}
                            <li class="page-item active">
                                <span class="page-link">{{ page_num }}</span>
                            </li>
                        {% endif %}
                    {% else %}
                        <li class="page-item disabled">
                            <span class="page-link">…</span>
                        </li>
                    {% endif %}
                {% endfor %}

                {% if registrations.has_next %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('admin.registrations', page=registrations.next_num) }}">შემდეგი</a>
                    </li>
                {% endif %}
            </ul>
        </nav>
    </div>
    {% endif %}
    {% else %}
    <div class="card-body">
        <div class="empty-state">
            <i class="fas fa-clipboard-list empty-icon"></i>
            <p class="empty-text">რეგისტრაციები ვერ მოიძებნა</p>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin/registrations.css') }}">

{% endblock %}
